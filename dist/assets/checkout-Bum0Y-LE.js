import{l as v,h as f,g as h,s as l,a as E,u as I}from"./utils-C06FxFqR.js";import{g as k,c as B}from"./maps-api-BPrFoTXr.js";const p="so-cart",b=.08,C=10,L=2,D=0;let r=!1,c=!1,u="delivery";function y(){const e=document.getElementById("place-order-btn");u==="pickup"?e.disabled=!r:e.disabled=!(r&&c)}function m(e,t){if(!e||e.length===0)return;const s=e.reduce((n,i)=>n+i.price*i.quantity,0),a=s*b;let o=0;t==="delivery"?(o=C+(e.length>1?(e.length-1)*L:0),document.getElementById("shipping-row").style.display="block"):(o=D,document.getElementById("shipping-row").style.display="none");const d=s+a+o;document.getElementById("subtotal-display").textContent=`$${s.toFixed(2)}`,document.getElementById("tax-display").textContent=`$${a.toFixed(2)}`,document.getElementById("shipping-display").textContent=`$${o.toFixed(2)}`,document.getElementById("total-display").textContent=`$${d.toFixed(2)}`}function S(e){const t=document.getElementById("calendar-container");if(!t)return;const s=(e||[]).map(n=>new Date(n.start.dateTime||n.start.date).toISOString().split("T")[0]),a=new Date,o=new Date;o.setDate(a.getDate()+90);const d=setInterval(()=>{window.flatpickr&&(clearInterval(d),flatpickr(t,{minDate:a,maxDate:o,disable:s,inline:!0,onChange:()=>{r=!0,y()}}))},100)}async function g(e){const t=document.getElementById("street-address").value,s=document.getElementById("city").value,a=document.getElementById("state").value,o=document.getElementById("zip").value,d=`${t}, ${s}, ${a} ${o}`,n=document.getElementById("delivery-message");if(t&&s&&a&&o){const i=await B(d);c=i,i?(n.textContent="✅ Your address is within our delivery range!",n.classList.add("success-message"),n.classList.remove("error-message")):(n.textContent="❌ Sorry, your address is outside our delivery range.",n.classList.add("error-message"),n.classList.remove("success-message"))}else c=!1,n.textContent="";y(),m(e,"delivery")}function P(e){const t=document.getElementById("delivery-toggle"),s=document.getElementById("pickup-toggle"),a=document.getElementById("address-section"),o=document.getElementById("map-container"),d=document.getElementById("pickup-info-card"),n=i=>{u=i,i==="delivery"?(a.style.display="block",o.style.display="block",d.style.display="none",t.classList.add("active"),s.classList.remove("active"),g(e)):(a.style.display="none",o.style.display="none",d.style.display="block",t.classList.remove("active"),s.classList.add("active"),m(e,"pickup"),y())};t.addEventListener("click",()=>n("delivery")),s.addEventListener("click",()=>n("pickup")),n("delivery")}function x(){const e=document.getElementById("place-order-btn");e.addEventListener("click",()=>{e.disabled&&(r?!c&&u==="delivery"&&l("Please enter a valid address within our delivery zone."):l("Please select a pickup or delivery date from the calendar."))})}async function T(e){e.preventDefault();const t=document.getElementById("checkout-form");if(t.checkValidity()){const s=new FormData(t),a=Object.fromEntries(s.entries());console.log("Form data submitted:",a),E(p,[]),I(),l("Placing your order...",3e3),setTimeout(()=>{t.reset(),document.querySelector("main.page-container").innerHTML='<h1>Thank You!</h1><p>Your order has been placed successfully.</p><a href="/order/" class="btn-primary">Continue Shopping</a>'},3e3)}else t.reportValidity(),l("Please fill out all required fields.")}async function w(){await v(),f();const e=h(p);if(!e||e.length===0){document.querySelector("main.page-container").innerHTML='<h1>Your Cart is Empty</h1><p>There are no items in your cart to check out.</p><a href="/order/" class="btn-primary">Shop Our Cheesecakes</a>';return}const t=await k();S(t),m(e,"delivery"),P(e),x(),document.getElementById("checkout-form").addEventListener("submit",T),["street-address","city","state","zip"].forEach(a=>{document.getElementById(a).addEventListener("blur",()=>g(e))})}w();
